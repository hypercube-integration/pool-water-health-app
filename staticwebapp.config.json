{
  "navigationFallback": {
    "rewrite": "/index.html",
    "exclude": ["/api/*", "/.auth/*", "/signed-out"]
  },
  "routes": [
    { "route": "/signed-out", "allowedRoles": ["anonymous"] },

    /* --- Admin UI (lock to admins only) --- */
    { "route": "/admin",   "allowedRoles": ["admin"] },
    { "route": "/admin/*", "allowedRoles": ["admin"] },

    /* --- Admin-only user management API --- */
    { "route": "/api/manageUsers",      "allowedRoles": ["admin"] },
    { "route": "/api/manageUsers/*",    "allowedRoles": ["admin"] },

    /* --- API endpoints with role rules --- */
    { "route": "/api/submitReading", "allowedRoles": ["writer", "admin"] },
    { "route": "/api/updateReading", "allowedRoles": ["editor", "admin"] },
    { "route": "/api/deleteReading", "allowedRoles": ["deleter", "admin"] },
    { "route": "/api/exportCSV",     "allowedRoles": ["exporter", "admin"] }

    /* If you previously locked down getReadings, keep/add this:
    ,{ "route": "/api/getReadings",  "allowedRoles": ["authenticated", "admin"] }
    */
  ],
  "responseOverrides": {
    "401": {
      "statusCode": 401,
      "rewrite": "/index.html"
    }
  }
}
